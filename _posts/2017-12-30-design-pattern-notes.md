---
layout: post
title: "浅谈设计模式"
categories: 架构模式
tags: [设计模式]
---

GoF的设计模式一书首次出版已经过去20多年，软件行业发展已经发生了巨大变化。书中提到的23种模式还有现实意义吗？关于各种具体模式的探讨已经汗牛充栋，这里只想谈谈我对设计模式的理解，权当抛砖引玉。

## 什么是模式？

> “设计模式为设计师们提供一种共通的词汇储备，帮助其沟通、编写文档并探索设计方案。设计模式允许我们立足于高级抽象层面进行探讨，而非设计标注或者编程语言，这就大大降低了系统复杂性。设计模式提升了我们设计及与同事进行设计探讨时的切入点层级。”   ---- 《设计模式：可复用面向对象软件的基础》

也就是说，模式实际上就是一种软件设计方案。此外可以看出，在GoF提出“设计模式”之前，模式就广泛存在软件开发活动中了。GoF只是指出软件开发中存在模式，并总结出一套描述方式，以方便软件设计师进行交流。书中提出的23种设计模式，只是当时最有代表性的23种模式，还有很多没有收录的设计模式。其实如果接触足够多的代码，必然有意无意间接触设计模式，只是不知道这个东西叫xx模式而已。

## 为什么要设计模式？

首先当然是为了方便交流，前面已经说过了。“一个对象管理者一堆依赖它的对象，当这个对象状态发生变化时可以通知它管理的对象”，这样的表述明显不如“观察者模式”来得直接。这个实际上是“命名”的好处，而不是设计模式本身的作用。

如上所述，设计模式是一种设计方案，是为了解决软件开发中的某些问题而提出。而其中最主要的问题就是软件变化的问题。也就是说我业务发生变化，软件应该怎么变。

大部分设计模式的目的就是**封装变化**，当业务发生变化的时候可以尽可能地少修改代码。反过来说，假设你的软件是一锤子买卖，或者可以接受重写的代价，那完全可以放弃设计模式。

那么所谓的**过度设计**就是封装了永远不可能变化的变化。这里其实是业务理解的问题，需要对业务有深入的了解才能做出比较好的设计（也就是脱离业务谈设计就有可能陷入过度设计）。

## 设计模式过时了吗？

是也不是。

毕竟GoF已经出版20多年了，现在软件开发跟20年前相比已经完全不同，如果只是抱着那23种模式，那无疑是掉进书袋里了。

举个例子，GoF一书的副标题是《可复用面向对象软件的基础》，也就是主要针对的是面向对象的语言（当初的C++，现在的Java），如果换成函数式的语言，解决方案就完全不一样了。如策略模式在函数式编程里就是一个函数参数而已，书上的那个类图就没有意义了（都是函数，哪来的类）。

还有比如建造者模式的定义是“将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示”，但是大多数Java中的Builder都是为了解决定长参数的问题，这已经和原先提出的模式作用发生了偏离。在其它一些语言中由于有动态类型和命名参数的存在，也就不需要另外搞一个Builder类了。

但是为什么又说没有过时呢，主要是因为解决问题的思想没有过时。软件开发虽然发展了这么多年，要解决的问题依旧存在（甚至更多），软件设计方案（模式）也就有存在的价值，可以被发现、描述、总结和复用。

## 如何学习/应用设计模式？

一些不成熟的小建议：

* 不建议在没有代码经验的情况下学习设计模式。
* 学习各种模式要解决的问题，以及解决问题的思路。
* 不要拿着锤子找钉子，在不明确问题域的情况下生搬硬套设计模式，这样容易陷入过度设计。当看不清楚变化点在哪里的时候尽量保持代码清晰简单（奥卡姆剃刀原则），当需要时可以随时重构即可。

## 参考资料

* [20年前GoF提出的设计模式，对这个时代是否还有指导意义？](http://www.infoq.com/cn/articles/design-patterns-proposed-by-gof-20-years-ago)
* [设计模式：可复用面向对象软件的基础](https://book.douban.com/subject/1052241/)